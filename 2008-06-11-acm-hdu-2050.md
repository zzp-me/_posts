---
layout: article
title: 2050 折线分割平面
date: 2008-06-11 20:04
category: 杭电100题
excerpt:
  我们看到过很多直线分割平面的题目，今天的这个题目稍微有些变化，
  我们要求的是n条折线分割平面的最大数目。
  比如，一条折线可以将平面分成两部分，两条折线最多可以将平面分成7部分
---
# 问题描述

## Problem Description

我们看到过很多直线分割平面的题目，今天的这个题目稍微有些变化，我们要求的是n条折线分割平面的最大数目。比如，一条折线可以将平面分成两部分，两条折线最多可以将平面分成7部分，具体如下所示。

{% img 1.jpg %}

## Input

输入数据的第一行是一个整数C,表示测试实例的个数，然后是C 行数据，每行包含一个整数n(0<n<=10000),表示折线的数量。

## Output

对于每个测试实例，请输出平面的最大分割数，每个实例的输出占一行。

## Sample Input

    2
    1
    2

## Sample Output

    2
    7

# 问题分析

## Problem Analyse

递推题

## Algorithm Analyse

我们不忙着解这道题。我们先来看一下N条相交的直线最多能把平面分割成几块。

{% img 2.gif %}

很明显，当添加第n条直线时，为了使平面最多，则第n条直线要与前面n-1条直线都相交，切没有任何三条线交于一个点。

这样，第n条直线一共有n-1个交点。我们知道，增加n个焦点，则增加n+1个平面。

所以n条直线分割平面最大数是1 + 1 + 2 + 3 + ... + n = (n<sup>2</sup> + n + 2) / 2

熟悉了线分割平面，现在，我们再来看看，每次增加的不是一条直线，而是两条相互平行的线，那又如何呢？

{% img 3.gif %}

当第N次添加时，前面已经有2N-2条直线了，按我们上面讨论的知道，第N次添加时，第2N-1条直线和第2N条直线各能增加2(n-1)+1个平面。

所以第N次添加增加的面数是2[2(n-1) + 1] = 4n - 2 个。因此，总面数应该是1 + 4n(n+1)/2 - 2n = 2n<sup>2</sup> + 1

现在我们再来看如果把每次加进来的平行边让它们一头相交，情况又如何呢？

{% img 4.gif %}

我们看到，平面1、3已经合为一个面，既少了一个面。因此，每当一组平行线相交后，就会减少一个面。

因此，本题所要求的折线分割平面，自然就是上面求的的平行线分割平面数减去N。

即2n<sup>2</sup> - n + 1

# 参考源码

{% gist 7499122 2050.cpp %}
